"use strict";
$(document).ready((function() {
    var t = window.location.href;
    if (t.includes("tovar_ne_nadlejashego_kacestva")) {
        $(".tabs__item").removeClass("tabs__item_active"),
        $(".tabs__item")[1].classList.add("tabs__item_active");
        var a = $(".main__btn")[0]
          , e = $(".main__btn")[2]
          , _ = $(".main__btn")[1];
        $(a).attr("id", "lawyer_page2_form2_click").attr("data-target", "lawyer_page2_form2"),
        $(_).attr("id", "lawyer_page2_form3_click").attr("data-target", "lawyer_page2_form3"),
        $(e).attr("id", "back_page2_form1_click").attr("data-target", "back_page2_form1"),
        $(".header__call").attr("id", "lawyer_link3").attr("data-target", "lawyer_page2_form1"),
        $(".question__form").attr("id", "question_page2_form1")
    } else
        $(".main__btn").attr("id", "back_index_form1_click").attr("data-target", "back_index_form1"),
        $(".header__call").attr("id", "lawyer_link1").attr("data-target", "lawyer_index_form1"),
        $(".question__form").attr("id", "question_index_form1");
    t.includes("kuplen") && ($(".tabs__item").removeClass("tabs__item_active"),
    $(".tabs__item")[2].classList.add("tabs__item_active"),
    $(".header__call").attr("id", "lawyer_link4").attr("data-target", "lawyer_page3_form1"),
    $(".question__form").attr("id", "question_page3_form1")),
    t.includes("ne_podoshel") && ($(".tabs__item").removeClass("tabs__item_active"),
    $(".tabs__item")[0].classList.add("tabs__item_active"),
    $(".main__btn").attr("id", "back_page1_form1_click").attr("data-target", "back_page1_form1"),
    $(".header__call").attr("id", "lawyer_link2").attr("data-target", "lawyer_page1_form1"),
    $(".question__form").attr("id", "question_page1_form1"));
    var o = {
        light: {
            id: "2688"
        },
        standart: {
            id: "2696"
        }
    };
    $(".tariff_light").show();
    var i = $("#sale_id").val();
    function l() {
        var t = [];
        return $(".newform__selector option").each((function(a, e) {
            t.push(e.value)
        }
        )),
        t
    }
    function n() {
        $(".newform__form").each((function(t) {
            var a = i;
            $.post("ExternalSale.php?a=init&rate_id=" + a, (function(t) {
                var a = JSON.parse(t);
                $("#sale_key").val(a.token),
                $("#sale_id").val(i)
            }
            ))
        }
        ))
    }
    $(".tariff__buy").click((function() {
        var t = $(this).data("tariff");
        l();
        i = o[t].id,
        function(t) {
            $(".tariff_" + t).prop("selected", !0)
        }(t),
        n()
    }
    )),
    n(),
    $(".newform__selector").change((function() {
        var t = $(".newform__selector option:selected").val();
        l();
        i = o[t].id,
        n()
    }
    )),
    $(".newform__form .form__btn").click((function() {
        $('[name="sale[mobile]"]').val().length > 1 && $('[name="sale[name]"]').val().length > 0 && $('[name="sale[email]"]').val().length > 1 && $("#check_hidden").is(":checked") && $(".newform__form").submit()
    }
    )),
    $(".modal__send").click((function() {
        var t = $("#modalTel").val();
        17 == t.length && $("#modalCheck").is(":checked") ? $.ajax({
            url: "./ajax/mail.php",
            type: "POST",
            data: {
                tel: t
            },
            success: function(t) {
                $(".modal__wrapper .question__form, .modal__send").fadeOut(),
                $(".modal__wrapper .question__title").text("Ваша заявка принята"),
                $(".modal__wrapper .question__textPrice").css("top", "240px")
            }
        }) : (17 != t.length ? ($(".modal__wrapper .input__title").css("color", "red"),
        $(".modal__wrapper .form__input").addClass("modal__input_anim"),
        setTimeout((function() {
            $(".modal__wrapper .form__input").removeClass("modal__input_anim")
        }
        ), 1e3)) : $(".input__title").css("color", "grey"),
        $("#modalCheck").is(":checked") ? $(".modal__wrapper .check__label").css("color", "#333333") : $(".modal__wrapper .check__label").css("color", "red"))
    }
    )),
    $(".scroll__newform").click((function() {
        var t = $(this).attr("href");
        return void 0 !== t && "" !== t && $("html").animate({
            scrollTop: $(t).offset().top
        }, 700),
        !1
    }
    )),
    $(".form__btn").click((function() {
        var t = $("#tel").val()
          , a = $("#email");
        17 == t.length && $("#check_hidden").is(":checked") ? $.ajax({
            url: "./ajax/mail.php",
            type: "POST",
            data: {
                tel: t
            },
            success: function(t) {
                // $(".question__form").fadeOut(),
                // $(".question__title").text("Ваша заявка принята"),
                // $(".question__textPrice").css("top", "240px")
            }
        }) : (17 != t.length ? ($(".input__title").css("color", "red"),
        $(".form__input").addClass("modal__input_anim"),
        setTimeout((function() {
            $(".form__input").removeClass("modal__input_anim")
        }
        ), 1e3)) : $(".input__title").css("color", "grey"),
        $("#check_hidden").is(":checked") ? $(".check__label").css("color", "#333333") : $(".check__label").css("color", "red"))
    }
    )),
    $(".toggler__title, .toggler__check").click((function() {
        $(this).parent().toggleClass("toggler__item_active"),
        $(this).parent().find(".toggler__content").slideToggle()
    }
    )),
    $("#tel").mask("+7 (999) 999-9999"),
    $("#modalTel").mask("+7 (999) 999-9999"),
    $("#newTel").mask("+7 (999) 999-9999"),
    $("#newformTel").mask("+7 (999) 999-9999"),
    $(".openModal").click((function() {
        var t = $(this).attr("data-target");
        $(".modal__block").attr("id", t),
        $(".modal").fadeIn("fast").addClass("modal_active"),
        $("body").css("overflow-y", "hidden")
    }
    )),
    $(".modal__close").click((function() {
        $("body").css("overflow-y", "unset"),
        $("html").css("padding-right", "0"),
        $(".modal").removeClass("modal_active"),
        $(".modal").fadeOut("fast")
    }
    )),
    $(document).keydown((function(t) {
        27 == t.which && ($(".modal").removeClass("modal_active"),
        $(".modal").fadeOut("fast"),
        $("body").css("overflow-y", "unset"),
        $("html").css("padding-right", "0"))
    }
    )),
    $(".form__input").keyup((function() {
        var t = $("#tel").val()
          , a = $(".input__mail")
          
        setTimeout((function() {
            17 == t.length && !a.hasClass("invalid")  && $("#check_hidden").is(":checked") ? $(".newform__btn").css("opacity", "1") : $(".newform__btn").css("opacity", "0.5")
        }
        ), 200)
    }
    )),
    $(".form__btn").click((function() {
        var t = $("#tel").val()
          , a = $("#email");
        if (17 == t.length && !a.hasClass("invalid") && $("#check_hidden").is(":checked")) {

            $.ajax({
            url: "./ajax/mail.php",
            type: "POST",
            data: {
                phone: t,
                email: a.val(),
                //name: e,
               // text: text
            },
            success: function(t) {
                gtag('event', 'submit', {'event_category' : 'form_event1'}); 
                ym(42964584,'reachGoal','lp_event_1');
                $('.question__main').fadeOut('fast');
                // $('.question__image').fadeOut('fast');
                $('.question__feedback').fadeIn('fast').css('display','flex');
            }
            })
            // var _ = $(this).attr("data-target");
            // $(".modal__block").attr("id", _),
            // $(".modal").fadeIn("fast").addClass("modal_active"),
            // $("body").css("overflow-y", "hidden");
            // setTimeout((function() {
            //     $(".newform__pay__frame").fadeIn("fast")
            // }
            // ), 400)
        }
    }
    )),
    $(document).click((function(t) {
        t.target == $(".modal__layout")[0] && ($(".modal").fadeOut("fast").removeClass("modal_active"),
        $("body").css("overflow-y", "visible"),
        $(".newform__pay__frame").fadeOut("fast"))
    }
    )),
    $(document).on("keyup", ".input__mail", (function() {
        var t = $(this).val();
        t.length > 0 && t.match(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/) ? $(this).removeClass("invalid") : (t.length,
        $(this).addClass("invalid"))
    }
    )),
    $(window).scroll((function() {
        0 != $(this).scrollTop() ? $(".top__btn").fadeIn() : $(".top__btn").fadeOut()
    }
    )),
    $(".top__btn").click((function() {
        $("body,html").animate({
            scrollTop: 0
        }, 800)
    }
    )),
    $(".video__btn").click((function(t) {
        t.preventDefault(),
        ym(42964584, "reachGoal", "razvod-video"),
        $(this).css("display", "none"),
        $(".video__hideBlock").fadeIn()
    }
    ))
}
));